{% extends "base.html" %}

{% block content %}
<h2>Смена пароля</h2>

<div class="form-card">
    <label>Текущий пароль</label>
    <input id="old_password" type="password">

    <label>Новый пароль</label>
    <input id="new_password" type="password">

    <label>Повторите новый пароль</label>
    <input id="new_password2" type="password">

    <button class="btn" onclick="changePassword()">Сменить пароль</button>
</div>

<script>
function changePassword() {
    const old_password = document.getElementById("old_password").value;
    const new_password = document.getElementById("new_password").value;
    const new_password2 = document.getElementById("new_password2").value;

    if (new_password !== new_password2) {
        alert("Пароли не совпадают");
        return;
    }

    fetch("/api/v1/security/change_password", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({ old_password, new_password })
    })
    .then(r => r.json())
    .then(data => {
        if (data.error) alert(data.error);
        else {
            alert("Пароль изменён");
            window.location.href = "/profile";
        }
    });
}
</script>

<style>
.form-card {
    background: var(--card);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid var(--border);
    display: flex;
    flex-direction: column;
    gap: 10px;
}
</style>

{% endblock %}
